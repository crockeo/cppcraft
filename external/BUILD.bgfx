cc_library(
    name = "bgfx",
    visibility = ["//visibility:public"],
    srcs = [
        "src/bgfx.cpp",
        "src/debug_renderdoc.cpp",
        "src/dxgi.cpp",
        "src/glcontext_egl.cpp",
        "src/glcontext_glx.cpp",
        "src/glcontext_html5.cpp",
        "src/glcontext_wgl.cpp",
        "src/nvapi.cpp",
        "src/renderer_d3d11.cpp",
        "src/renderer_d3d12.cpp",
        "src/renderer_d3d9.cpp",
        "src/renderer_gl.cpp",
        "src/renderer_gnm.cpp",
        "src/renderer_noop.cpp",
        "src/renderer_nvn.cpp",
        "src/renderer_vk.cpp",
        "src/renderer_webgpu.cpp",
        "src/shader.cpp",
        "src/shader_dx9bc.cpp",
        "src/shader_dxbc.cpp",
        "src/shader_spirv.cpp",
        "src/topology.cpp",
        "src/vertexlayout.cpp",
    ],
    hdrs = glob([
        "**/*.h",
        "**/*.inl",
    ]),
    deps = [
        "@bimg//:bimg",
        "@bx//:bx",
    ],
    defines = [
        "BGFX_CONFIG_RENDERER_VULKAN=0",
        "BGFX_CONFIG_RENDERER_METAL=1",
    ],
    includes = [
        "3rdparty",
        "3rdparty/khronos",
        "include",
    ],
)

objc_library(
    name = "bgfx_macos",
    visibility = ["//visibility:public"],
    srcs = [
        "src/glcontext_eagl.mm",
        "src/glcontext_nsgl.mm",
        "src/renderer_mtl.mm",
    ],
    hdrs = glob([
        "**/*.h",
        "**/*.inl",
    ]),
    includes = [
        "include",
    ],
    sdk_frameworks = [
        "Cocoa",
        "Metal",
        "QuartzCore",
    ],
    copts = [
        "-fno-objc-arc",
    ],
    deps = [":bgfx"],
)